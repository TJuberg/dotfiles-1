#!/usr/bin/env bash

# Check git
if ! which git >/dev/null; then
    echo "You need to install git to use this dotfiles repo. EXITING..."
    echo "Setting up git:"
    echo "    sudo apt-get install git"
    exit -1
fi

# Check rcm
if ! which rcup >/dev/null; then
    echo "You need to install rcm to use this dotfiles repo. EXITING..."
    echo "Setting up rcm:"
    echo "    # Instructions from https://github.com/thoughtbot/rcm"
    echo "    sudo add-apt-repository ppa:martin-frost/thoughtbot-rcm"
    echo "    sudo apt-get update"
    echo "    sudo apt-get install rcm"
    exit -1
fi

# Check tmux
if which tmux >/dev/null && [[ $(tmux -V) != 'tmux 2.0' ]]; then
    echo "This dotfiles repository is only compatible with tmux 2.0. EXITING..."
    echo "Setting up tmux-2.0:"
    echo "    sudo apt-get install build-essential libncurses5-dev libevent1-dev libncurses5 libevent-1.4"
    echo "    wget https://github.com/tmux/tmux/releases/download/2.0/tmux-2.0.tar.gz"
    echo "    tar xzf tmux-2.0.tar.gz"
    echo "    cd tmux-2.0"
    echo "    ./configure"
    echo "    make"
    echo "    sudo make install"
    exit -1
fi

echo -n "Installing dotfiles... "
if [ -e "$HOME/.dotfiles" ]; then
    echo "$HOME/.dotfiles directory already exists. EXITING..."
    exit -1
else
    git clone https://github.com/kmARC11/dotfiles.git "$HOME/.dotfiles"
    echo "DONE"
fi

echo "Using rcup to set up dotfiles..."
RCRC="$HOME/.dotfiles/rcrc" rcup

echo "DONE"
